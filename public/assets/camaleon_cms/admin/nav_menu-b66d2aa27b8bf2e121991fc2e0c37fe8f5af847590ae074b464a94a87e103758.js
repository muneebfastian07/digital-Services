(function(){$(function(){var t,i,n,e,r,a;return r=$("#menu_content"),n=$("#menu_form"),i=$("#menus_list"),e=$("#menu_items"),i.nestable(),t={items:i.nestable("serialize")},i.on("change",function(){var n;if(n={items:i.nestable("serialize")},JSON.stringify(t)!==JSON.stringify(n))return r.find("#menu_reoreder_loading").show(),$.post(i.attr("data-reorder_url"),n,function(i){if(t=n,r.find("#menu_reoreder_loading").hide(),i)return alert(i)})}),a=function(t){return showLoading(),$.post(i.attr("data-url"),t,function(t){return i.children(".dd-list").append($(t).children()),hideLoading()})},e.find(".add_links_to_menu").click(function(){var t,i;return t={items:[],authenticity_token:n.find('[name="authenticity_token"]').val()},i=!1,$(this).closest(".panel").find("input:checkbox:checked").each(function(){return i=!0,t.items.push({id:$(this).val(),kind:$(this).closest(".class_type").attr("data-type")})}).prop("checked",!1),!!i&&(a(t),!1)}),e.find(".add_links_custom_to_menu").click(function(){var t,i;return t={custom_items:[],authenticity_token:n.find('[name="authenticity_token"]').val()},i=!1,$(this).closest(".panel").find("input:checkbox:checked").each(function(){return i=!0,t.custom_items.push({url:$(this).val(),kind:$(this).attr("data-kind"),label:$(this).attr("data-label")})}).prop("checked",!1),!!i&&(a(t),!1)}),e.find(".form-custom-link").submit(function(){var t;return t=$(this),!!t.valid()&&(a({external:t.serializeObject()}),this.reset(),setTimeout(function(){return t.find("label.error").hide()},100),!1)}),i.on("click",".item_external",function(){var t;return t=$(this),open_modal({title:t.attr("data-original-title")||t.attr("title"),url:t.attr("href"),mode:"ajax",callback:function(i){var n;return n=i.find("form"),init_form_validations(n),n.submit(function(){return!!n.valid()&&(showLoading(),$.post(n.attr("action"),n.serialize(),function(n){return t.closest("li").replaceWith($(n).html()),i.modal("hide"),hideLoading()}),!1)})}}),!1}),i.on("click",".delete_menu_item",function(){var t;return t=$(this),!!confirm(I18n("msg.confirm_del","Are you sure to delete this item?"))&&(showLoading(),$.get(t.attr("href"),function(){return t.closest(".dd-item").remove(),hideLoading()}),!1)}),r.find(".new_menu_link, .edit_menu_link").ajax_modal({callback:function(t){var i;return i=t.find("form"),setTimeout(function(){return init_form_validations(i)},1e3)}}),r.find("#menu_items #switch_nav_menu_form select").change(function(){if($(this).val())return $(this).closest("form").submit()}),i.on("click",".custom_settings_link",function(){var t;return t=$(this),open_modal({title:t.attr("data-original-title")||t.attr("title"),url:t.attr("href"),mode:"ajax",callback:function(t){var i;return i=t.find("form"),init_form_validations(i),i.submit(function(){return!!i.valid()&&(showLoading(),$.post(i.attr("action"),i.serialize(),function(i){return i&&alert(i),t.modal("hide"),hideLoading()}),!1)})}}),!1})})}).call(this);