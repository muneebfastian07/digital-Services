function open_modal(t){var e={title:"",content:null,url:null,show_footer:!1,mode:"inline",ajax_params:{},id:"ow_inline_modal",zindex:null,modal_size:"",type:"",modal_settings:{},on_submit:null,callback:function(){},on_close:function(){}};if(t=$.extend({},e,t),t.id){var i=$("#"+t.id);if(i.length)return i.modal("show"),i}var a=$('<div id="'+t.id+'" class="modal fade modal-'+t.type+'"><div class="modal-dialog '+t.modal_size+'"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button><h4 class="modal-title">'+t.title+'</h4></div><div class="modal-body"></div>'+(t.show_footer||t.on_submit?'<div class="modal-footer"> '+(t.on_submit?'<button type="button" class="btn btn-primary modal_submit" ><i class="fa fa-save"></i> '+I18n("button.save")+"</button>":"")+' <button type="button" class="btn btn-default" data-dismiss="modal"><i class="fa fa-arrow-circle-down"></i> '+I18n("button.close")+"</button></div>":"")+"</div></div></div>");return a.on("hidden.bs.modal",function(e){t.on_close(a),$(e.currentTarget).attr("data-skip_destroy")||$(e.currentTarget).remove(),modal_fix_multiple()}),t.zindex&&a.css("z-index",t.zindex),t.on_submit&&a.find(".modal-footer .modal_submit").click(function(){t.on_submit(a)}),a.on("show.bs.modal",function(){a.find(".modal-title").text()||a.find(".modal-header .close").css("margin-top","-9px"),t.callback(a)}),"inline"==t.mode?(a.find(".modal-body").html(t.content),a.modal(t.modal_settings)):"iframe"==t.mode?(a.find(".modal-body").html('<iframe id="ow_inline_modal_iframe" style="min-height: 500px;" src="'+t.url+'" width="100%" frameborder=0></iframe>'),a.modal(t.modal_settings)):(showLoading(),$.get(t.url,t.ajax_params,function(e){a.find(".modal-body").html(e),hideLoading(),a.modal(t.modal_settings)})),a}function showLoading(){$.fn.customLoading("show")}function hideLoading(){$.fn.customLoading("hide")}!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t("undefined"!=typeof jQuery?jQuery:window.Zepto)}(function(t){"use strict";function e(e){var i=e.data;e.isDefaultPrevented()||(e.preventDefault(),t(e.target).ajaxSubmit(i))}function i(e){var i=e.target,a=t(i);if(!a.is("[type=submit],[type=image]")){var r=a.closest("[type=submit]");if(0===r.length)return;i=r[0]}var o=this;if(o.clk=i,"image"==i.type)if(e.offsetX!==undefined)o.clk_x=e.offsetX,o.clk_y=e.offsetY;else if("function"==typeof t.fn.offset){var n=a.offset();o.clk_x=e.pageX-n.left,o.clk_y=e.pageY-n.top}else o.clk_x=e.pageX-i.offsetLeft,o.clk_y=e.pageY-i.offsetTop;setTimeout(function(){o.clk=o.clk_x=o.clk_y=null},100)}function a(){if(t.fn.ajaxSubmit.debug){var e="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(e):window.opera&&window.opera.postError&&window.opera.postError(e)}}var r={};r.fileapi=t("<input type='file'/>").get(0).files!==undefined,r.formdata=window.FormData!==undefined;var o=!!t.fn.prop;t.fn.attr2=function(){if(!o)return this.attr.apply(this,arguments);var t=this.prop.apply(this,arguments);return t&&t.jquery||"string"==typeof t?t:this.attr.apply(this,arguments)},t.fn.ajaxSubmit=function(e){function i(i){var a,r,o=t.param(i,e.traditional).split("&"),n=o.length,s=[];for(a=0;a<n;a++)o[a]=o[a].replace(/\+/g," "),r=o[a].split("="),s.push([decodeURIComponent(r[0]),decodeURIComponent(r[1])]);return s}function n(a){for(var r=new FormData,o=0;o<a.length;o++)r.append(a[o].name,a[o].value);if(e.extraData){var n=i(e.extraData);for(o=0;o<n.length;o++)n[o]&&r.append(n[o][0],n[o][1])}e.data=null;var s=t.extend(!0,{},t.ajaxSettings,e,{contentType:!1,processData:!1,cache:!1,type:l||"POST"});e.uploadProgress&&(s.xhr=function(){var i=t.ajaxSettings.xhr();return i.upload&&i.upload.addEventListener("progress",function(t){var i=0,a=t.loaded||t.position,r=t.total;t.lengthComputable&&(i=Math.ceil(a/r*100)),e.uploadProgress(t,a,r,i)},!1),i}),s.data=null;var d=s.beforeSend;return s.beforeSend=function(t,i){e.formData?i.data=e.formData:i.data=r,d&&d.call(this,t,i)},t.ajax(s)}function s(i){function r(t){var e=null;try{t.contentWindow&&(e=t.contentWindow.document)}catch(t){a("cannot get iframe.contentWindow document: "+t)}if(e)return e;try{e=t.contentDocument?t.contentDocument:t.document}catch(i){a("cannot get iframe.contentDocument: "+i),e=t.document}return e}function n(){function e(){try{var t=r(v).readyState;a("state = "+t),t&&"uninitialized"==t.toLowerCase()&&setTimeout(e,50)}catch(t){a("Server abort: ",t," (",t.name,")"),s($),y&&clearTimeout(y),y=undefined}}var i=h.attr2("target"),o=h.attr2("action"),n="multipart/form-data",d=h.attr("enctype")||h.attr("encoding")||n;C.setAttribute("target",m),l&&!/post/i.test(l)||C.setAttribute("method","POST"),o!=p.url&&C.setAttribute("action",p.url),p.skipEncodingOverride||l&&!/post/i.test(l)||h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),p.timeout&&(y=setTimeout(function(){x=!0,s(k)},p.timeout));var c=[];try{if(p.extraData)for(var u in p.extraData)p.extraData.hasOwnProperty(u)&&(t.isPlainObject(p.extraData[u])&&p.extraData[u].hasOwnProperty("name")&&p.extraData[u].hasOwnProperty("value")?c.push(t('<input type="hidden" name="'+p.extraData[u].name+'">').val(p.extraData[u].value).appendTo(C)[0]):c.push(t('<input type="hidden" name="'+u+'">').val(p.extraData[u]).appendTo(C)[0]));p.iframeTarget||g.appendTo("body"),v.attachEvent?v.attachEvent("onload",s):v.addEventListener("load",s,!1),setTimeout(e,15);try{C.submit()}catch(t){var f=document.createElement("form").submit;f.apply(C)}}finally{C.setAttribute("action",o),C.setAttribute("enctype",d),i?C.setAttribute("target",i):h.removeAttr("target"),t(c).remove()}}function s(e){if(!b.aborted&&!F){if(B=r(v),B||(a("cannot access response document"),e=$),e===k&&b)return b.abort("timeout"),void D.reject(b,"timeout");if(e==$&&b)return b.abort("server abort"),void D.reject(b,"error","server abort");if(B&&B.location.href!=p.iframeSrc||x){v.detachEvent?v.detachEvent("onload",s):v.removeEventListener("load",s,!1);var i,o="success";try{if(x)throw"timeout";var n="xml"==p.dataType||B.XMLDocument||t.isXMLDoc(B);if(a("isXml="+n),!n&&window.opera&&(null===B.body||!B.body.innerHTML)&&--j)return a("requeing onLoad callback, DOM not available"),void setTimeout(s,250);var l=B.body?B.body:B.documentElement;b.responseText=l?l.innerHTML:null,b.responseXML=B.XMLDocument?B.XMLDocument:B,n&&(p.dataType="xml"),b.getResponseHeader=function(t){return{"content-type":p.dataType}[t.toLowerCase()]},l&&(b.status=Number(l.getAttribute("status"))||b.status,b.statusText=l.getAttribute("statusText")||b.statusText);var d=(p.dataType||"").toLowerCase(),c=/(json|script|text)/.test(d);if(c||p.textarea){var h=B.getElementsByTagName("textarea")[0];if(h)b.responseText=h.value,b.status=Number(h.getAttribute("status"))||b.status,b.statusText=h.getAttribute("statusText")||b.statusText;else if(c){var m=B.getElementsByTagName("pre")[0],f=B.getElementsByTagName("body")[0];m?b.responseText=m.textContent?m.textContent:m.innerText:f&&(b.responseText=f.textContent?f.textContent:f.innerText)}}else"xml"==d&&!b.responseXML&&b.responseText&&(b.responseXML=E(b.responseText));try{L=M(b,d,p)}catch(t){o="parsererror",b.error=i=t||o}}catch(t){a("error caught: ",t),o="error",b.error=i=t||o}b.aborted&&(a("upload aborted"),o=null),b.status&&(o=b.status>=200&&b.status<300||304===b.status?"success":"error"),"success"===o?(p.success&&p.success.call(p.context,L,"success",b),D.resolve(b.responseText,"success",b),u&&t.event.trigger("ajaxSuccess",[b,p])):o&&(i===undefined&&(i=b.statusText),p.error&&p.error.call(p.context,b,o,i),D.reject(b,"error",i),u&&t.event.trigger("ajaxError",[b,p,i])),u&&t.event.trigger("ajaxComplete",[b,p]),u&&!--t.active&&t.event.trigger("ajaxStop"),p.complete&&p.complete.call(p.context,b,o),F=!0,p.timeout&&clearTimeout(y),setTimeout(function(){p.iframeTarget?g.attr("src",p.iframeSrc):g.remove(),b.responseXML=null},100)}}}var d,c,p,u,m,g,v,b,w,_,x,y,C=h[0],D=t.Deferred();if(D.abort=function(t){b.abort(t)},i)for(c=0;c<f.length;c++)d=t(f[c]),o?d.prop("disabled",!1):d.removeAttr("disabled");if(p=t.extend(!0,{},t.ajaxSettings,e),p.context=p.context||p,m="jqFormIO"+(new Date).getTime(),p.iframeTarget?(g=t(p.iframeTarget),_=g.attr2("name"),_?m=_:g.attr2("name",m)):(g=t('<iframe name="'+m+'" src="'+p.iframeSrc+'" />'),g.css({position:"absolute",top:"-1000px",left:"-1000px"})),v=g[0],b={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(e){var i="timeout"===e?"timeout":"aborted";a("aborting upload... "+i),this.aborted=1;try{v.contentWindow.document.execCommand&&v.contentWindow.document.execCommand("Stop")}catch(t){}g.attr("src",p.iframeSrc),b.error=i,p.error&&p.error.call(p.context,b,i,e),u&&t.event.trigger("ajaxError",[b,p,i]),p.complete&&p.complete.call(p.context,b,i)}},u=p.global,u&&0==t.active++&&t.event.trigger("ajaxStart"),u&&t.event.trigger("ajaxSend",[b,p]),p.beforeSend&&!1===p.beforeSend.call(p.context,b,p))return p.global&&t.active--,D.reject(),D;if(b.aborted)return D.reject(),D;(w=C.clk)&&(_=w.name)&&!w.disabled&&(p.extraData=p.extraData||{},p.extraData[_]=w.value,"image"==w.type&&(p.extraData[_+".x"]=C.clk_x,p.extraData[_+".y"]=C.clk_y));var k=1,$=2,T=t("meta[name=csrf-token]").attr("content"),S=t("meta[name=csrf-param]").attr("content");S&&T&&(p.extraData=p.extraData||{},p.extraData[S]=T),p.forceSync?n():setTimeout(n,10);var L,B,F,j=50,E=t.parseXML||function(t,e){return window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t)):e=(new DOMParser).parseFromString(t,"text/xml"),e&&e.documentElement&&"parsererror"!=e.documentElement.nodeName?e:null},z=t.parseJSON||function(t){return window.eval("("+t+")")},M=function(e,i,a){var r=e.getResponseHeader("content-type")||"",o="xml"===i||!i&&r.indexOf("xml")>=0,n=o?e.responseXML:e.responseText;return o&&"parsererror"===n.documentElement.nodeName&&t.error&&t.error("parsererror"),a&&a.dataFilter&&(n=a.dataFilter(n,i)),"string"==typeof n&&("json"===i||!i&&r.indexOf("json")>=0?n=z(n):("script"===i||!i&&r.indexOf("javascript")>=0)&&t.globalEval(n)),n};return D}if(!this.length)return a("ajaxSubmit: skipping submit process - no element selected"),this;var l,d,c,h=this;"function"==typeof e?e={success:e}:e===undefined&&(e={}),l=e.type||this.attr2("method"),d=e.url||this.attr2("action"),c="string"==typeof d?t.trim(d):"",c=c||window.location.href||"",c&&(c=(c.match(/^([^#]+)/)||[])[1]),e=t.extend(!0,{url:c,success:t.ajaxSettings.success,type:l||t.ajaxSettings.type,iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},e);var p={};if(this.trigger("form-pre-serialize",[this,e,p]),p.veto)return a("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(e.beforeSerialize&&!1===e.beforeSerialize(this,e))return a("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var u=e.traditional;u===undefined&&(u=t.ajaxSettings.traditional);var m,f=[],g=this.formToArray(e.semantic,f);if(e.data&&(e.extraData=e.data,m=t.param(e.data,u)),e.beforeSubmit&&!1===e.beforeSubmit(g,this,e))return a("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[g,this,e,p]),p.veto)return a("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var v=t.param(g,u);m&&(v=v?v+"&"+m:m),"GET"==e.type.toUpperCase()?(e.url+=(e.url.indexOf("?")>=0?"&":"?")+v,e.data=null):e.data=v;var b=[];if(e.resetForm&&b.push(function(){h.resetForm()}),e.clearForm&&b.push(function(){h.clearForm(e.includeHidden)}),!e.dataType&&e.target){var w=e.success||function(){};b.push(function(i){var a=e.replaceTarget?"replaceWith":"html";t(e.target)[a](i).each(w,arguments)})}else e.success&&b.push(e.success);if(e.success=function(t,i,a){for(var r=e.context||this,o=0,n=b.length;o<n;o++)b[o].apply(r,[t,i,a||h,h])},e.error){var _=e.error;e.error=function(t,i,a){var r=e.context||this;_.apply(r,[t,i,a,h])}}if(e.complete){var x=e.complete;e.complete=function(t,i){var a=e.context||this;x.apply(a,[t,i,h])}}var y=t("input[type=file]:enabled",this).filter(function(){return""!==t(this).val()}),C=y.length>0,D="multipart/form-data",k=h.attr("enctype")==D||h.attr("encoding")==D,$=r.fileapi&&r.formdata;a("fileAPI :"+$);var T,S=(C||k)&&!$;!1!==e.iframe&&(e.iframe||S)?e.closeKeepAlive?t.get(e.closeKeepAlive,function(){T=s(g)}):T=s(g):T=(C||k)&&$?n(g):t.ajax(e),h.removeData("jqxhr").data("jqxhr",T);for(var L=0;L<f.length;L++)f[L]=null;return this.trigger("form-submit-notify",[this,e]),this},t.fn.ajaxForm=function(r){if(r=r||{},r.delegation=r.delegation&&t.isFunction(t.fn.on),!r.delegation&&0===this.length){var o={s:this.selector,c:this.context};return!t.isReady&&o.s?(a("DOM not ready, queuing ajaxForm"),t(function(){t(o.s,o.c).ajaxForm(r)}),this):(a("terminating; zero elements found by selector"+(t.isReady?"":" (DOM not ready)")),this)}return r.delegation?(t(document).off("submit.form-plugin",this.selector,e).off("click.form-plugin",this.selector,i).on("submit.form-plugin",this.selector,r,e).on("click.form-plugin",this.selector,r,i),this):this.ajaxFormUnbind().bind("submit.form-plugin",r,e).bind("click.form-plugin",r,i)},t.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},t.fn.formToArray=function(e,i){var a=[];if(0===this.length)return a;var o,n=this[0],s=this.attr("id"),l=e?n.getElementsByTagName("*"):n.elements;if(l&&!/MSIE [678]/.test(navigator.userAgent)&&(l=t(l).get()),s&&(o=t(':input[form="'+s+'"]').get(),o.length&&(l=(l||[]).concat(o))),!l||!l.length)return a;var d,c,h,p,u,m,f;for(d=0,m=l.length;d<m;d++)if(u=l[d],(h=u.name)&&!u.disabled)if(e&&n.clk&&"image"==u.type)n.clk==u&&(a.push({name:h,value:t(u).val(),type:u.type}),a.push({name:h+".x",value:n.clk_x},{name:h+".y",value:n.clk_y}));else if((p=t.fieldValue(u,!0))&&p.constructor==Array)for(i&&i.push(u),c=0,f=p.length;c<f;c++)a.push({name:h,value:p[c]});else if(r.fileapi&&"file"==u.type){i&&i.push(u);var g=u.files;if(g.length)for(c=0;c<g.length;c++)a.push({name:h,value:g[c],type:u.type});else a.push({name:h,value:"",type:u.type})}else null!==p&&void 0!==p&&(i&&i.push(u),a.push({name:h,value:p,type:u.type,required:u.required}));if(!e&&n.clk){var v=t(n.clk),b=v[0];h=b.name,h&&!b.disabled&&"image"==b.type&&(a.push({name:h,value:v.val()}),a.push({name:h+".x",value:n.clk_x},{name:h+".y",value:n.clk_y}))}return a},t.fn.formSerialize=function(e){return t.param(this.formToArray(e))},t.fn.fieldSerialize=function(e){var i=[];return this.each(function(){var a=this.name;if(a){var r=t.fieldValue(this,e);if(r&&r.constructor==Array)for(var o=0,n=r.length;o<n;o++)i.push({name:a,value:r[o]});else null!==r&&void 0!==r&&i.push({name:this.name,value:r})}}),t.param(i)},t.fn.fieldValue=function(e){for(var i=[],a=0,r=this.length;a<r;a++){var o=this[a],n=t.fieldValue(o,e);null===n||void 0===n||n.constructor==Array&&!n.length||(n.constructor==Array?t.merge(i,n):i.push(n))}return i},t.fieldValue=function(e,i){var a=e.name,r=e.type,o=e.tagName.toLowerCase();if(i===undefined&&(i=!0),i&&(!a||e.disabled||"reset"==r||"button"==r||("checkbox"==r||"radio"==r)&&!e.checked||("submit"==r||"image"==r)&&e.form&&e.form.clk!=e||"select"==o&&-1==e.selectedIndex))return null;if("select"==o){var n=e.selectedIndex;if(n<0)return null;for(var s=[],l=e.options,d="select-one"==r,c=d?n+1:l.length,h=d?n:0;h<c;h++){var p=l[h];if(p.selected){var u=p.value;if(u||(u=p.attributes&&p.attributes.value&&!p.attributes.value.specified?p.text:p.value),d)return u;s.push(u)}}return s}return t(e).val()},t.fn.clearForm=function(e){return this.each(function(){t("input,select,textarea",this).clearFields(e)})},t.fn.clearFields=t.fn.clearInputs=function(e){var i=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var a=this.type,r=this.tagName.toLowerCase();i.test(a)||"textarea"==r?this.value="":"checkbox"==a||"radio"==a?this.checked=!1:"select"==r?this.selectedIndex=-1:"file"==a?/MSIE/.test(navigator.userAgent)?t(this).replaceWith(t(this).clone(!0)):t(this).val(""):e&&(!0===e&&/hidden/.test(a)||"string"==typeof e&&t(this).is(e))&&(this.value="")})},t.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},t.fn.enable=function(t){return t===undefined&&(t=!0),this.each(function(){this.disabled=!t})},t.fn.selected=function(e){return e===undefined&&(e=!0),this.each(function(){var i=this.type;if("checkbox"==i||"radio"==i)this.checked=e;else if("option"==this.tagName.toLowerCase()){var a=t(this).parent("select");e&&a[0]&&"select-one"==a[0].type&&a.find("option").selected(!1),this.selected=e}})},t.fn.ajaxSubmit.debug=!1}),function(t){void 0==jQuery.fn.ajaxForm&&t.getScript(("https:"==document.location.protocol?"https://":"http://")+"malsup.github.io/jquery.form.js");var e={};e.fileapi=void 0!==t("<input type='file'/>").get(0).files,e.formdata=void 0!==window.FormData,t.fn.uploadFile=function(i){function a(){C||(C=!0,function t(){if(v.sequential||(v.sequentialCount=99999),0==x.length&&0==y.length)v.afterUploadAll&&v.afterUploadAll(w),C=!1;else{if(y.length<v.sequentialCount){var e=x.shift();void 0!=e&&(y.push(e),e.submit())}window.setTimeout(t,100)}}())}function r(e,i,a){a.on("dragenter",function(e){e.stopPropagation(),e.preventDefault(),t(this).addClass(i.dragDropHoverClass)}),a.on("dragover",function(e){e.stopPropagation(),e.preventDefault();var a=t(this);a.hasClass(i.dragDropContainerClass)&&!a.hasClass(i.dragDropHoverClass)&&a.addClass(i.dragDropHoverClass)}),a.on("drop",function(a){a.preventDefault(),t(this).removeClass(i.dragDropHoverClass),e.errorLog.html("");var r=a.originalEvent.dataTransfer.files;return!i.multiple&&r.length>1?void(i.showError&&t("<div class='"+i.errorClass+"'>"+i.multiDragErrorStr+"</div>").appendTo(e.errorLog)):void(0!=i.onSelect(r)&&s(i,e,r))}),a.on("dragleave",function(){t(this).removeClass(i.dragDropHoverClass)}),t(document).on("dragenter",function(t){t.stopPropagation(),t.preventDefault()}),t(document).on("dragover",function(e){e.stopPropagation(),e.preventDefault();var a=t(this);a.hasClass(i.dragDropContainerClass)||a.removeClass(i.dragDropHoverClass)}),t(document).on("drop",function(e){e.stopPropagation(),e.preventDefault(),t(this).removeClass(i.dragDropHoverClass)})}function o(t){var e="",i=t/1024;if(parseInt(i)>1024){e=(i/1024).toFixed(2)+" MB"}else e=i.toFixed(2)+" KB";return e}function n(e){var i=[];i="string"==jQuery.type(e)?e.split("&"):t.param(e).split("&");var a,r,o=i.length,n=[];for(a=0;o>a;a++)i[a]=i[a].replace(/\+/g," "),r=i[a].split("="),n.push([decodeURIComponent(r[0]),decodeURIComponent(r[1])]);return n}function s(e,i,a){for(var r=0;r<a.length;r++)if(l(i,e,a[r].name))if(e.allowDuplicates||!d(i,a[r].name))if(-1!=e.maxFileSize&&a[r].size>e.maxFileSize)e.showError&&t("<div class='"+e.errorClass+"'><b>"+a[r].name+"</b> "+e.sizeErrorStr+o(e.maxFileSize)+"</div>").appendTo(i.errorLog);else if(-1!=e.maxFileCount&&i.selectedFiles>=e.maxFileCount)e.showError&&t("<div class='"+e.errorClass+"'><b>"+a[r].name+"</b> "+e.maxFileCountErrorStr+e.maxFileCount+"</div>").appendTo(i.errorLog);else{i.selectedFiles++,i.existingFileNames.push(a[r].name);var s=e,c=new FormData,h=e.fileName.replace("[]","");c.append(h,a[r]);var p=e.formData;if(p)for(var u=n(p),m=0;m<u.length;m++)u[m]&&c.append(u[m][0],u[m][1]);s.fileData=c;var v=new f(i,e),b="";b=e.showFileCounter?i.fileCounter+e.fileCounterStyle+a[r].name:a[r].name,e.showFileSize&&(b+=" ("+o(a[r].size)+")"),v.filename.html(b);var w=t("<form style='display:block; position:absolute;left: 150px;' class='"+i.formGroup+"' method='"+e.method+"' action='"+e.url+"' enctype='"+e.enctype+"'></form>");w.appendTo("body");var _=[];_.push(a[r].name),g(w,s,v,_,i,a[r]),i.fileCounter++}else e.showError&&t("<div class='"+e.errorClass+"'><b>"+a[r].name+"</b> "+e.duplicateErrorStr+"</div>").appendTo(i.errorLog);else e.showError&&t("<div class='"+e.errorClass+"'><b>"+a[r].name+"</b> "+e.extErrorStr+e.allowedTypes+"</div>").appendTo(i.errorLog)}function l(t,e,i){var a=e.allowedTypes.toLowerCase().split(/[\s,]+/g),r=i.split(".").pop().toLowerCase();return!("*"!=e.allowedTypes&&jQuery.inArray(r,a)<0)}function d(t,e){var i=!1;if(t.existingFileNames.length)for(var a=0;a<t.existingFileNames.length;a++)(t.existingFileNames[a]==e||v.duplicateStrict&&t.existingFileNames[a].toLowerCase()==e.toLowerCase())&&(i=!0);return i}function c(t,e){if(t.existingFileNames.length)for(var i=0;i<e.length;i++){var a=t.existingFileNames.indexOf(e[i]);-1!=a&&t.existingFileNames.splice(a,1)}}function h(t,e){if(t){e.show();var i=new FileReader;i.onload=function(t){e.attr("src",t.target.result)},i.readAsDataURL(t)}}function p(e,i){if(e.showFileCounter){var a=t(i.container).find(".ajax-file-upload-filename").length;i.fileCounter=a+1,t(i.container).find(".ajax-file-upload-filename").each(function(){var i=t(this).html().split(e.fileCounterStyle),r=(parseInt(i[0]),a+e.fileCounterStyle+i[1]);t(this).html(r),a--})}}function u(i,a,r,o){var n="ajax-upload-id-"+(new Date).getTime(),d=t("<form method='"+r.method+"' action='"+r.url+"' enctype='"+r.enctype+"'></form>"),c="<input type='file' id='"+n+"' name='"+r.fileName+"' accept='"+r.acceptFiles+"'/>";r.multiple&&(r.fileName.indexOf("[]")!=r.fileName.length-2&&(r.fileName+="[]"),c="<input type='file' id='"+n+"' name='"+r.fileName+"' accept='"+r.acceptFiles+"' multiple/>");var h=t(c).appendTo(d);h.change(function(){i.errorLog.html("");var n=(r.allowedTypes.toLowerCase().split(","),[]);if(this.files){for(b=0;b<this.files.length;b++)n.push(this.files[b].name);if(0==r.onSelect(this.files))return}else{var c=t(this).val(),h=[];if(n.push(c),!l(i,r,c))return void(r.showError&&t("<div class='"+r.errorClass+"'><b>"+c+"</b> "+r.extErrorStr+r.allowedTypes+"</div>").appendTo(i.errorLog));if(h.push({name:c,size:"NA"}),0==r.onSelect(h))return}if(p(r,i),o.unbind("click"),d.hide(),u(i,a,r,o),d.addClass(a),r.serialize&&e.fileapi&&e.formdata){d.removeClass(a);var m=this.files;d.remove(),s(r,i,m)}else{for(var v="",b=0;b<n.length;b++)v+=r.showFileCounter?i.fileCounter+r.fileCounterStyle+n[b]+"<br>":n[b]+"<br>",i.fileCounter++;if(-1!=r.maxFileCount&&i.selectedFiles+n.length>r.maxFileCount)return void(r.showError&&t("<div class='"+r.errorClass+"'><b>"+v+"</b> "+r.maxFileCountErrorStr+r.maxFileCount+"</div>").appendTo(i.errorLog));i.selectedFiles+=n.length;var w=new f(i,r);w.filename.html(v),g(d,r,w,n,i,null)}}),r.nestedForms?(d.css({margin:0,padding:0}),o.css({position:"relative",overflow:"hidden",cursor:"default"}),h.css({position:"absolute",cursor:"pointer",top:"0px",width:"100%",height:"100%",left:"0px","z-index":"100",opacity:"0.0",filter:"alpha(opacity=0)","-ms-filter":"alpha(opacity=0)","-khtml-opacity":"0.0","-moz-opacity":"0.0"}),d.appendTo(o)):(d.appendTo(t("body")),d.css({margin:0,padding:0,display:"block",position:"absolute",left:"-250px"}),-1!=navigator.appVersion.indexOf("MSIE ")?o.attr("for",n):o.click(function(){h.click()}))}function m(e,i){return this.statusbar=t("<div class='ajax-file-upload-statusbar'></div>").width(i.statusBarWidth),this.preview=t("<img class='ajax-file-upload-preview' />").width(i.previewWidth).height(i.previewHeight).appendTo(this.statusbar).hide(),this.filename=t("<div class='ajax-file-upload-filename'></div>").appendTo(this.statusbar),this.progressDiv=t("<div class='ajax-file-upload-progress'>").appendTo(this.statusbar).hide(),this.progressbar=t("<div class='ajax-file-upload-bar'></div>").appendTo(this.progressDiv),this.abort=t("<div>"+i.abortStr+"</div>").appendTo(this.statusbar).hide(),this.cancel=t("<div>"+i.cancelStr+"</div>").appendTo(this.statusbar).hide(),this.done=t("<div>"+i.doneStr+"</div>").appendTo(this.statusbar).hide(),this.download=t("<div>"+i.downloadStr+"</div>").appendTo(this.statusbar).hide(),this.del=t("<div>"+i.deletelStr+"</div>").appendTo(this.statusbar).hide(),this.abort.addClass("ajax-file-upload-red"),this.done.addClass("ajax-file-upload-green"),this.download.addClass("ajax-file-upload-green"),this.cancel.addClass("ajax-file-upload-red"),this.del.addClass("ajax-file-upload-red"),this}function f(e,i){var a=null;return a=i.customProgressBar?new i.customProgressBar(e,i):new m(e,i),a.abort.addClass(e.formGroup),a.abort.addClass(i.abortButtonClass),a.cancel.addClass(e.formGroup),a.cancel.addClass(i.cancelButtonClass),i.extraHTML&&(a.extraHTML=t("<div class='extrahtml'>"+i.extraHTML()+"</div>").insertAfter(a.filename)),"bottom"==i.uploadQueuOrder?t(e.container).append(a.statusbar):t(e.container).prepend(a.statusbar),a}function g(i,r,o,s,l,d){var u={cache:!1,contentType:!1,processData:!1,forceSync:!1,type:r.method,data:r.formData,formData:r.fileData,dataType:r.returnType,beforeSubmit:function(e,a,d){if(0!=r.onSubmit.call(this,s)){if(r.dynamicFormData){var h=n(r.dynamicFormData());if(h)for(var u=0;u<h.length;u++)h[u]&&(void 0!=r.fileData?d.formData.append(h[u][0],h[u][1]):d.data[h[u][0]]=h[u][1])}return r.extraHTML&&t(o.extraHTML).find("input,select,textarea").each(function(){void 0!=r.fileData?d.formData.append(t(this).attr("name"),t(this).val()):d.data[t(this).attr("name")]=t(this).val()}),!0}return o.statusbar.append("<div class='"+r.errorClass+"'>"+r.uploadErrorStr+"</div>"),o.cancel.show(),i.remove(),o.cancel.click(function(){x.splice(x.indexOf(i),1),c(l,s),o.statusbar.remove(),r.onCancel.call(l,s,o),l.selectedFiles-=s.length,p(r,l)}),!1},beforeSend:function(t){o.progressDiv.show(),o.cancel.hide(),o.done.hide(),r.showAbort&&(o.abort.show(),o.abort.click(function(){c(l,s),t.abort(),l.selectedFiles-=s.length,r.onAbort.call(l,s,o)})),o.progressbar.width(e.formdata?"1%":"5%")},uploadProgress:function(t,e,i,a){a>98&&(a=98);var n=a+"%";a>1&&o.progressbar.width(n),r.showProgress&&(o.progressbar.html(n),o.progressbar.css("text-align","center"))},success:function(e,a,n){if(o.cancel.remove(),y.pop(),"json"==r.returnType&&"object"==t.type(e)&&e.hasOwnProperty(r.customErrorKeyStr)){o.abort.hide();var d=e[r.customErrorKeyStr];return r.onError.call(this,s,200,d,o),r.showStatusAfterError?(o.progressDiv.hide(),o.statusbar.append("<span class='"+r.errorClass+"'>ERROR: "+d+"</span>")):(o.statusbar.hide(),o.statusbar.remove()),l.selectedFiles-=s.length,void i.remove()}l.responses.push(e),o.progressbar.width("100%"),r.showProgress&&(o.progressbar.html("100%"),o.progressbar.css("text-align","center")),o.abort.hide(),r.onSuccess.call(this,s,e,n,o),r.showStatusAfterSuccess?(r.showDone?(o.done.show(),o.done.click(function(){o.statusbar.hide("slow"),o.statusbar.remove()})):o.done.hide(),r.showDelete?(o.del.show(),o.del.click(function(){o.statusbar.hide().remove(),r.deleteCallback&&r.deleteCallback.call(this,e,o),l.selectedFiles-=s.length,p(r,l)})):o.del.hide()):(o.statusbar.hide("slow"),o.statusbar.remove()),r.showDownload&&(o.download.show(),o.download.click(function(){r.downloadCallback&&r.downloadCallback(e)})),i.remove()},error:function(t,e,a){o.cancel.remove(),y.pop(),o.abort.hide(),"abort"==t.statusText?(o.statusbar.hide("slow").remove(),p(r,l)):(r.onError.call(this,s,e,a,o),r.showStatusAfterError?(o.progressDiv.hide(),o.statusbar.append("<span class='"+r.errorClass+"'>ERROR: "+a+"</span>")):(o.statusbar.hide(),o.statusbar.remove()),l.selectedFiles-=s.length),i.remove()}};r.showPreview&&null!=d&&"image"==d.type.toLowerCase().split("/").shift()&&h(d,o.preview),r.autoSubmit?(i.ajaxForm(u),x.push(i),a()):(r.showCancel&&(o.cancel.show(),o.cancel.click(function(){x.splice(x.indexOf(i),1),c(l,s),i.remove(),o.statusbar.remove(),r.onCancel.call(l,s,o),l.selectedFiles-=s.length,p(r,l)})),i.ajaxForm(u))}var v=t.extend({url:"",method:"POST",enctype:"multipart/form-data",returnType:null,allowDuplicates:!0,duplicateStrict:!1,allowedTypes:"*",acceptFiles:"*",fileName:"file",formData:!1,dynamicFormData:!1,maxFileSize:-1,maxFileCount:-1,multiple:!0,dragDrop:!0,autoSubmit:!0,showCancel:!0,showAbort:!0,showDone:!1,showDelete:!1,showError:!0,showStatusAfterSuccess:!0,showStatusAfterError:!0,showFileCounter:!0,fileCounterStyle:"). ",showFileSize:!0,showProgress:!1,nestedForms:!0,showDownload:!1,onLoad:function(){},onSelect:function(){return!0},onSubmit:function(){},onSuccess:function(){},onError:function(){},onCancel:function(){},onAbort:function(){},downloadCallback:!1,deleteCallback:!1,afterUploadAll:!1,serialize:!0,sequential:!1,sequentialCount:2,customProgressBar:!1,abortButtonClass:"ajax-file-upload-abort",cancelButtonClass:"ajax-file-upload-cancel",dragDropContainerClass:"ajax-upload-dragdrop",dragDropHoverClass:"state-hover",errorClass:"ajax-file-upload-error",uploadButtonClass:"ajax-file-upload",dragDropStr:"<span><b>Drag & Drop Files</b></span>",uploadStr:"Upload",abortStr:"Abort",cancelStr:"Cancel",deletelStr:"Delete",doneStr:"Done",multiDragErrorStr:"Multiple File Drag & Drop is not allowed.",extErrorStr:"is not allowed. Allowed extensions: ",duplicateErrorStr:"is not allowed. File already exists.",sizeErrorStr:"is not allowed. Allowed Max size: ",uploadErrorStr:"Upload is not allowed",maxFileCountErrorStr:" is not allowed. Maximum allowed files are:",downloadStr:"Download",customErrorKeyStr:"jquery-upload-file-error",showQueueDiv:!1,statusBarWidth:400,dragdropWidth:400,showPreview:!1,previewHeight:"auto",previewWidth:"100%",extraHTML:!1,uploadQueuOrder:"top"},i);this.fileCounter=1,this.selectedFiles=0;var b="ajax-file-upload-"+(new Date).getTime();this.formGroup=b,this.errorLog=t("<div></div>"),this.responses=[],this.existingFileNames=[],e.formdata||(v.dragDrop=!1),e.formdata||(v.multiple=!1),t(this).html("");var w=this,_=t("<div>"+v.uploadStr+"</div>");t(_).addClass(v.uploadButtonClass),function e(){if(t.fn.ajaxForm){if(v.dragDrop){var i=t('<div class="'+v.dragDropContainerClass+'" style="vertical-align:top;"></div>').width(v.dragdropWidth);t(w).append(i),t(i).append(_),t(i).append(t(v.dragDropStr)),r(w,v,i)}else t(w).append(_);t(w).append(w.errorLog),w.container=v.showQueueDiv?t("#"+v.showQueueDiv):t("<div class='ajax-file-upload-container'></div>").insertAfter(t(w)),v.onLoad.call(this,w),u(w,b,v,_)}else window.setTimeout(e,10)}(),this.startUpload=function(){t("form").each(function(){t(this).hasClass(w.formGroup)&&x.push(t(this))}),x.length>=1&&a()},this.getFileCount=function(){return w.selectedFiles},this.stopUpload=function(){t("."+v.abortButtonClass).each(function(){t(this).hasClass(w.formGroup)&&t(this).click()}),t("."+v.cancelButtonClass).each(function(){t(this).hasClass(w.formGroup)&&t(this).click()})},this.cancelAll=function(){t("."+v.cancelButtonClass).each(function(){t(this).hasClass(w.formGroup)&&t(this).click()})},this.update=function(e){v=t.extend(v,e)},this.reset=function(t){w.fileCounter=1,w.selectedFiles=0,w.errorLog.html(""),0!=t&&w.container.html("")},this.remove=function(){w.container.html(""),t(w).remove()},this.createProgress=function(t,e,i){var a=new f(this,v);a.progressDiv.show(),a.progressbar.width("100%");var r="";r=v.showFileCounter?w.fileCounter+v.fileCounterStyle+t:t,v.showFileSize&&(r+=" ("+o(i)+")"),a.filename.html(r),w.fileCounter++,w.selectedFiles++,v.showPreview&&(a.preview.attr("src",e),a.preview.show()),v.showDownload&&(a.download.show(),a.download.click(function(){v.downloadCallback&&v.downloadCallback.call(w,[t])})),v.showDelete&&(a.del.show(),a.del.click(function(){a.statusbar.hide().remove();var e=[t];v.deleteCallback&&v.deleteCallback.call(this,e,a),w.selectedFiles-=1,p(v,w)}))},this.getResponses=function(){return this.responses};var x=[],y=[],C=!1;return this}}(jQuery),function(){window.cama_init_media=function(media_panel){var customFileData,file_data,media_files_panel,media_info,media_info_tab_info,media_link_tab_upload,p_upload,show_file;return media_info=media_panel.find(".media_file_info"),media_files_panel=media_panel.find(".media_browser_list"),media_info_tab_info=media_panel.find(".media_file_info_col .nav-tabs .link_media_info"),media_link_tab_upload=media_panel.find(".media_file_info_col .nav-tabs .link_media_upload"),file_data=function(item){var data;return data=item.data("eval-data")||eval("("+item.find(".data_value").val()+")"),item.data("eval-data",data),data},show_file=function(t){var e,i,a,r,o;if(t.addClass("selected").siblings().removeClass("selected"),e=file_data(t),media_info_tab_info.click(),o="<div class='p_thumb'></div><div class='p_label'><b>"+I18n("button.name")+": </b><br> <span>"+e.name+"</span></div><div class='p_body'><div style='overflow: auto;'><b>"+I18n("button.url")+":</b><br> <a target='_blank' href='"+e.url+"'>"+e.url+"</a></div><div><b>"+I18n("button.size")+":</b> <span>"+cama_humanFileSize(e.size)+"</span></div></div>",
window.callback_media_uploader&&(!media_panel.attr("data-formats")||media_panel.attr("data-formats")&&($.inArray(e.format,media_panel.attr("data-formats").split(","))>=0||$.inArray(e.url.split(".").pop().toLowerCase(),media_panel.attr("data-formats").split(","))>=0))&&(o+="<div class='p_footer'><button class='btn btn-primary insert_btn'>"+I18n("button.insert")+"</button></div>"),media_info.html(o),media_info.find(".p_thumb").html(t.find(".thumb").html()),"image"===e.format&&(t.find(".edit_item")&&(a=$('<button type="button" class="pull-right btn btn-default" title="Edit"><i class="fa fa-pencil"></i></button>').click(function(){return t.find(".edit_item").trigger("click")})),media_info.find(".p_footer").append(a),i=function(){var t,i,a,r,o,n;if(n=parseInt(e.dimension.split("x")[0]),o=parseInt(e.dimension.split("x")[1]),media_info.find(".p_body").append("<div class='cdimension'><b>"+I18n("button.dimension")+": </b><span>"+n+"x"+o+"</span></div>"),media_panel.attr("data-dimension"))return a=media_info.find(".p_footer .insert_btn"),a.prop("disabled",!0),i=parseInt(media_panel.attr("data-dimension").split("x")[0])||n,t=parseInt(media_panel.attr("data-dimension").split("x")[1])||o,media_info.find(".cdimension").append("<span style='color: black;'> ==> "+media_panel.attr("data-dimension")+"</span>"),i===n&&t===o?a.prop("disabled",!1):(media_info.find(".cdimension").css("color","red"),r=$("<button class='btn btn-info pull-right'><i class='fa fa-crop'></i> "+I18n("button.auto_crop")+"</button>").click(function(){var t;return t=e.name.split("."),t[t.length-2]+="_"+media_panel.attr("data-dimension"),$.fn.upload_url({url:e.url,name:t.join(".")})}),a.after(r))},!e.dimension&&media_panel.attr("data-dimension")?(r=new Image,r.onload=function(){return e.dimension=this.width+"x"+this.height,t.data("eval-data",e),i()},r.src=e.url):i()),window.callback_media_uploader)return media_info.find(".insert_btn").click(function(){return e.mime=e.type,window.callback_media_uploader(e),window.callback_media_uploader=null,media_panel.closest(".modal").modal("hide"),!1})},media_panel.on("click",".file_item",function(){return show_file($(this)),!1}).on("dblclick",".file_item",function(){var t;if((t=media_info.find(".insert_btn"))&&!t.attr("disabled")&&!t.attr("readonly"))return t.trigger("click")}),media_files_panel.scroll(function(){if(media_files_panel.attr("data-next-page")&&$(this).scrollTop()+$(this).outerHeight()===$(this)[0].scrollHeight)return media_panel.trigger("navigate_to",{paginate:!0,custom_params:{page:media_files_panel.attr("data-next-page")}})}),p_upload=media_panel.find(".cama_media_fileuploader"),customFileData=function(){var t;return t=cama_media_get_custom_params(),t.skip_auto_crop=!0,t},p_upload.uploadFile({url:p_upload.attr("data-url"),fileName:"file_upload",sequential:!0,sequentialCount:1,uploadButtonClass:"btn btn-primary btn-block",dragDropStr:'<span style="display: block;"><b>'+p_upload.attr("data-dragDropStr")+"</b></span>",uploadStr:p_upload.attr("data-uploadStr"),dynamicFormData:customFileData,onSuccess:function(t,e,i,a){return e.search("media_item")>=0?(media_panel.trigger("add_file",{item:e,selected:0===$(a.statusbar).siblings().not(".error_file_upload").length}),$(a.statusbar).remove()):$(a.statusbar).find(".ajax-file-upload-progress").html("<span style='color: red;'>"+e+"</span>")},onError:function(t,e,i,a){return $(a.statusbar).addClass("error_file_upload").find(".ajax-file-upload-filename").append(" <i class='fa fa-times btn btn-danger btn-xs' onclick='$(this).closest(\".ajax-file-upload-statusbar\").remove();'></i>")}}),media_panel.find(".media_folder_breadcrumb").on("click","a",function(){return media_panel.trigger("navigate_to",{folder:$(this).attr("data-path")}),!1}),media_panel.on("click",".folder_item",function(){var t;return t=media_panel.attr("data-folder")+"/"+$(this).attr("data-key"),$(this).attr("data-key").search("/")>=0&&(t=$(this).attr("data-key")),media_panel.trigger("navigate_to",{folder:t.replace(/\/{2,}/g,"/")})}),media_panel.bind("update_breadcrumb",function(){var t,e,i,a,r,o,n,s,l;for(e=media_panel.attr("data-folder").replace("//","/"),a=[],i="/"===e||""===e?["/"]:e.split("/"),t=[],r=o=0,n=i.length;o<n;r=++o)l=i[r],s=l,"/"!==l&&""!==l||(s=I18n("button.root")),r===i.length-1?t.push("<li><span>"+s+"</span></li>"):(a.push(l),t.push("<li><a data-path='"+(a.join("/")||"/").replace(/\/{2,}/g,"/")+"' href='#'>"+s+"</a></li>"));return media_panel.find(".media_folder_breadcrumb").html(t.join(""))}).trigger("update_breadcrumb"),media_panel.bind("navigate_to",function(t,e){var i,a;return e.folder&&media_panel.attr("data-folder",e.folder),i=media_panel.attr("data-folder"),media_panel.trigger("update_breadcrumb"),a=cama_media_get_custom_params({partial:!0,folder:i}),e.paginate?a=media_panel.data("last_req_params")||a:(media_info.html(""),media_link_tab_upload.click()),media_panel.data("last_req_params",$.extend({},a,e.custom_params||{})),showLoading(),$.getJSON(media_panel.attr("data-url"),media_panel.data("last_req_params"),function(t){var i;return e.paginate?media_files_panel.children(".file_item").length>0?media_files_panel.append(t.html):(i=media_files_panel.children(".folder_item:last"),1===i.length?i.after(t.html):media_files_panel.append(t.html)):media_files_panel.html(t.html),media_files_panel.attr("data-next-page",t.next_page),hideLoading()})}).bind("add_file",function(t,e){var i,a;return i=$(e.item).hide(),a=media_files_panel.children(".folder_item:last"),1===a.length?a.after(i):media_files_panel.prepend(i),!0!==e.selected&&void 0!==e.selected||i.click(),media_files_panel.scrollTop(0),i.fadeIn(1500)}),media_panel.find("#cama_search_form").submit(function(){return media_panel.trigger("navigate_to",{custom_params:{search:$(this).find("input:text").val()}}),!1}),media_panel.find(".cam_media_reload").click(function(t){return media_panel.trigger("navigate_to",{custom_params:{cama_media_reload:$(this).attr("data-action")}}),t.preventDefault()}),media_panel.on("click","a.add_folder",function(){var t,e;return e=$("<form id='add_folder_form'><div><label for=''>"+I18n("button.folder")+": </label> <div class='input-group'><input name='folder' class='form-control required' placeholder='Folder name..'><span class='input-group-btn'><button class='btn btn-primary' type='submit'>"+I18n("button.create")+"</button></span></div></div> </form>"),t=function(t){var e,i;return e=t.find(".btn-primary"),i=t.find("input").keyup(function(){return $(this).val()?e.removeAttr("disabled"):e.attr("disabled","true")}).trigger("keyup"),t.find("form").submit(function(){return showLoading(),$.post(media_panel.attr("data-url_actions"),cama_media_get_custom_params({folder:media_panel.attr("data-folder")+"/"+i.val(),media_action:"new_folder"}),function(e){return hideLoading(),t.modal("hide"),e.search("folder_item")>=0?(e=$(e),media_files_panel.append(e),e.click()):$.fn.alert({type:"error",content:e,title:"Error"})}),!1})},open_modal({title:"New Folder",content:e,callback:t,zindex:9999999}),!1}),media_panel.on("click","a.del_item, a.del_folder",function(){var t,e;return!!confirm(I18n("msg.delete_item"))&&(e=$(this),t=e.closest(".media_item"),showLoading(),$.post(media_panel.attr("data-url_actions"),cama_media_get_custom_params({folder:media_panel.attr("data-folder")+"/"+t.attr("data-key"),media_action:e.hasClass("del_folder")?"del_folder":"del_file"}),function(e){return hideLoading(),e?$.fn.alert({type:"error",content:e,title:I18n("button.error")}):(t.remove(),media_info.html(""))}).error(function(){return $.fn.alert({type:"error",content:I18n("msg.internal_error"),title:I18n("button.error")})}),!1)}),media_panel.on("click",".edit_item",function(){var cropper,cropper_data,data,edit_callback,item,link;return link=$(this),item=link.closest(".media_item"),data=file_data(item),cropper=null,cropper_data=null,edit_callback=function(modal){var btn,cmd,field_height,field_width,icon,ref,save_btn,save_image;field_width=modal.find(".export_image .with_image"),field_height=modal.find(".export_image .height_image"),save_image=function(t,e){return $.fn.upload_url({url:cropper.cropper("getCroppedCanvas",{width:field_width.val(),height:field_height.val()}).toDataURL("image/jpeg"),name:t,same_name:e,callback:function(){return modal.modal("hide")}})},ref={arrows:"('setDragMode', 'move')",crop:"('setDragMode', 'crop')","search-plus":"('zoom', 0.1)","search-minus":"('zoom', -0.1)","arrow-left":"('move', -10, 0)","arrow-right":"('move', 10, 0)","arrow-up":"('move', 0, -10)","arrow-down":"('move', 0, 10)","rotate-left":"('rotate', -45)","rotate-right":"('rotate', 45)","arrows-h":"('scaleX', -1)","arrows-v":"('scaleY', -1)",refresh:"('reset')"};for(icon in ref)cmd=ref[icon],btn=$('<button type="button" class="btn btn-default" data-cmd="'+cmd+'"><i class="fa fa-'+icon+'"></i></button>'),modal.find(".editor_controls").append(btn),btn.click(function(){if(btn=$(this),cmd=btn.data("cmd"),"('scaleY', -1)"===cmd||"('scaleX', -1)"===cmd?btn.data("cmd",cmd.replace("-1","1")):"('scaleY', 1)"!==cmd&&"('scaleX', 1)"!==cmd||btn.data("cmd",cmd.replace("1","-1")),eval("cropper.cropper"+cmd),"('reset')"===cmd)return cropper.cropper("setData",cropper_data.data)});return save_btn=modal.find(".export_image").submit(function(){var t;return!!$(this).valid()&&(t=function(t){return t.find("img.preview").attr("src",cropper.cropper("getCroppedCanvas",{width:field_width.val(),height:field_height.val()}).toDataURL("image/jpeg")),t.find(".save_btn").click(function(){return save_image(data.name,!0),t.modal("hide"),item.remove()}),t.find("form").validate({submitHandler:function(){return save_image(t.find(".file_name").val()+"."+data.name.split(".").pop()),t.modal("hide"),!1}})},open_modal({zindex:999992,modal_size:"modal-lg",id:"media_preview_editted_image",content:'<div class="text-center" style="overflow: auto;"><img class="preview"></div><br><div class="row"><div class="col-md-4"><button class="btn save_btn btn-default">'+I18n("button.replace_image")+'</button></div><div class="col-md-8"><form class="input-group"><input type="text" class="form-control file_name required" name="file_name"><div class="input-group-btn"><button class="btn btn-primary" type="submit">'+I18n("button.save_new_image")+"</button></div></form></div></div>",callback:t}),!1)}).validate(),field_width.change(function(){var t;if(!field_width.attr("readonly"))return t=modal.find(".cropper-crop-box"),field_height.val(parseInt(parseInt($(this).val())/t.width()*t.height()))}),showLoading(),modal.find("img.editable").load(function(){return setTimeout(function(){var t,e;return e=modal.find(".label_dimension"),cropper_data={data:{},minContainerHeight:450,modal:!0,crop:function(t){if(e.html(Math.round(t.width)+" x "+Math.round(t.height)),field_width.attr("readonly")||field_width.val(Math.round(t.width)),!field_height.attr("readonly"))return field_height.val(Math.round(t.height))},built:function(){return $.get(data.url).error(function(){return modal.find(".modal-body").html('<div class="alert alert-danger">'+I18n("msg.cors_error",'Please verify the following: <ul><li>If the image exist: %{url_img}</li> <li>Check if cors configuration are defined well, only for external images: S3, cloudfront(if you are using cloudfront).</li></ul><br> More information about CORS: <a href="%{url_blog}" target="_blank">here.</a>',{url_img:data.url,url_blog:"http://blog.celingest.com/en/2014/10/02/tutorial-using-cors-with-cloudfront-and-s3/"})+"</div>")})}},media_panel.attr("data-dimension")&&(t=media_panel.attr("data-dimension").split("x"),t[0]&&(cropper_data.data.width=parseFloat(t[0].match(/\d+/)[0]),field_width.val(cropper_data.data.width),t[0].search(/\?/)>-1?field_width.attr("max",cropper_data.data.width):field_width.prop("readonly",!0)),t[1]&&(cropper_data.data.height=parseFloat(t[1].match(/\d+/)[0]),field_height.val(cropper_data.data.height),t[1].search(/\?/)>-1?field_height.attr("max",cropper_data.data.height):field_height.prop("readonly",!0)),t[0]&&-1===t[0].search(/\?/)&&t[1]&&-1===t[1].search(/\?/)&&(cropper_data.aspectRatio=cropper_data.data.width/cropper_data.data.height)),cropper=modal.find("img.editable").cropper(cropper_data),hideLoading()},300)})},open_modal({zindex:999991,id:"media_panel_editor_image",title:I18n("button.edit_image","Edit Image")+" - "+data.name+(media_panel.attr("data-dimension")?" <small><i>("+media_panel.attr("data-dimension")+")</i></small>":""),content:'<div><div class="editable_wrapper"><img style="max-width: 100%;" class="editable" id="media_editable_image" src="'+data.url+'"></div><div class="row" style="margin-top: 5px;"><div class="col-md-8"><div class="editor_controls btn-group"></div></div><div class="col-md-4"><form class="export_image"> <div class="input-group"><input class="form-control with_image data-error-place-parent required number" placeholder="Width"><span class="input-group-addon">x</span><input class="form-control height_image data-error-place-parent required number" placeholder="Height"> <span class="input-group-btn"><button class="btn btn-primary save_image" type="submit"><i class="fa fa-save"></i> '+I18n("button.save","Save Image")+'</button> </span> </div></form></div></div><!--span class="label label-default pull-right label_dimension"></span--></div>',callback:edit_callback,modal_size:"modal-lg"}),!1}),media_panel.find("#cama_media_external").submit(function(){return!!$(this).valid()&&($.fn.upload_url({url:$(this).find("input").val(),skip_auto_crop:!0,callback:function(){return media_panel.find("#cama_media_external")[0].reset()}}),!1)}).validate()},window.cama_media_get_custom_params=function(custom_settings){var media_panel,r;return media_panel=$("#cama_media_gallery"),r=eval("("+media_panel.attr("data-extra-params")+")"),r.folder=media_panel.attr("data-folder"),custom_settings&&$.extend(r,custom_settings),r.folder=r.folder.replace(/\/{2,}/g,"/"),r},$(function(){return $.fn.upload_url=function(t){var e,i;return i=$("#cama_media_gallery"),e=cama_media_get_custom_params({media_action:"crop_url",onerror:function(t){return $.fn.alert({type:"error",content:t,title:I18n("msg.error_uploading")})}}),$.extend(e,t),e.onerror,delete e.onerror,showLoading(),$.post(i.attr("data-url_actions"),e,function(t){return hideLoading(),t.search("media_item")>=0?(i.trigger("add_file",{item:t}),e.callback?e.callback(t):void 0):$.fn.alert({type:"error",content:t,title:I18n("button.error")})}).error(function(){return $.fn.alert({type:"error",content:I18n("msg.internal_error"),title:I18n("button.error")})})}}),$(function(){return $.fn.upload_filemanager=function(t){return t=t||{},"null"===t.formats&&(t.formats=""),"null"===t.dimension&&(t.dimension=""),"null"===t.versions&&(t.versions=""),"null"===t.thumb_size&&(t.thumb_size=""),open_modal({title:t.title||I18n("msg.media_title"),id:"cama_modal_file_uploader",modal_size:"modal-lg",mode:"ajax",url:root_admin_url+"/media/ajax",ajax_params:{media_formats:t.formats,dimension:t.dimension,versions:t.versions,thumb_size:t.thumb_size,"private":t["private"]},callback:function(e){return t.selected&&(window.callback_media_uploader=t.selected),e.css("z-index",t.zindex||99999).children(".modal-dialog").css("width","90%")}})}}),window.cama_humanFileSize=function(t){var e,i;for(i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],e=0;t>=1024;)t/=1024,++e;return t.toFixed(1)+" "+i[e]}}.call(this),function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t("object"==typeof exports?require("jquery"):jQuery)}(function(t){"use strict";function e(t){return"number"==typeof t&&!isNaN(t)}function i(t){return void 0===t}function a(t,i){var a=[];return e(i)&&a.push(i),a.slice.apply(t,a)}function r(t,e){var i=a(arguments,2);return function(){return t.apply(e,i.concat(a(arguments)))}}function o(t){var e=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return e&&(e[1]!==_.protocol||e[2]!==_.hostname||e[3]!==_.port)}function n(t){var e="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+e}function s(t){return t?' crossOrigin="'+t+'"':""}function l(t,e){var i;if(t.naturalWidth&&!ut)return e(t.naturalWidth,t.naturalHeight);i=document.createElement("img"),i.onload=function(){e(this.width,this.height)},i.src=t.src}function d(t){var i=[],a=t.rotate,r=t.scaleX,o=t.scaleY;return e(a)&&0!==a&&i.push("rotate("+a+"deg)"),e(r)&&1!==r&&i.push("scaleX("+r+")"),e(o)&&1!==o&&i.push("scaleY("+o+")"),i.length?i.join(" "):"none"}function c(t,e){var i,a,r=vt(t.degree)%180,o=(r>90?180-r:r)*Math.PI/180,n=bt(o),s=wt(o),l=t.width,d=t.height,c=t.aspectRatio;return e?(i=l/(s+n/c),a=i/c):(i=l*s+d*n,a=l*n+d*s),{width:i,height:a}}function h(i,a){var r,o,n,s=t("<canvas>")[0],l=s.getContext("2d"),d=0,h=0,p=a.naturalWidth,u=a.naturalHeight,m=a.rotate,f=a.scaleX,g=a.scaleY,v=e(f)&&e(g)&&(1!==f||1!==g),b=e(m)&&0!==m,w=b||v,_=p*vt(f||1),x=u*vt(g||1);return v&&(r=_/2,o=x/2),b&&(n=c({width:_,height:x,degree:m}),_=n.width,x=n.height,r=_/2,o=x/2),s.width=_,s.height=x,w&&(d=-p/2,h=-u/2,l.save(),l.translate(r,o)),b&&l.rotate(m*Math.PI/180),v&&l.scale(f,g),l.drawImage(i,yt(d),yt(h),yt(p),yt(u)),w&&l.restore(),s}function p(e){var i=e.length,a=0,r=0;return i&&(t.each(e,function(t,e){a+=e.pageX,r+=e.pageY}),a/=i,r/=i),{pageX:a,pageY:r}}function u(t,e,i){var a,r="";for(a=e,i+=e;a<i;a++)r+=Ct(t.getUint8(a));return r}function m(t){var e,i,a,r,o,n,s,l,d,c,h=new D(t),p=h.byteLength;if(255===h.getUint8(0)&&216===h.getUint8(1))for(d=2;d<p;){if(255===h.getUint8(d)&&225===h.getUint8(d+1)){s=d;break}d++}if(s&&(i=s+4,a=s+10,"Exif"===u(h,i,4)&&(n=h.getUint16(a),((o=18761===n)||19789===n)&&42===h.getUint16(a+2,o)&&(r=h.getUint32(a+4,o))>=8&&(l=a+r))),l)for(p=h.getUint16(l,o),c=0;c<p;c++)if(d=l+12*c+2,274===h.getUint16(d,o)){d+=8,e=h.getUint16(d,o),ut&&h.setUint16(d,1,o);break}return e}function f(t){var e,i=t.replace(K,""),a=atob(i),r=a.length,o=new y(r),n=new C(o);for(e=0;e<r;e++)n[e]=a.charCodeAt(e);return o}function g(t){var e,i=new C(t),a=i.length,r="";for(e=0;e<a;e++)r+=Ct(i[e]);return"data:image/jpeg;base64,"+k(r)}function v(e,i){this.$element=t(e),this.options=t.extend({},v.DEFAULTS,t.isPlainObject(i)&&i),this.isLoaded=!1,this.isBuilt=!1,this.isCompleted=!1,this.isRotated=!1,this.isCropped=!1,this.isDisabled=!1,this.isReplaced=!1,this.isLimited=!1,this.wheeling=!1,this.isImg=!1,this.originalUrl="",this.canvas=null,this.cropBox=null,this.init()}var b=t(window),w=t(document),_=window.location,x=window.navigator,y=window.ArrayBuffer,C=window.Uint8Array,D=window.DataView,k=window.btoa,$="cropper",T="cropper-modal",S="cropper-hide",L="cropper-hidden",B="cropper-move",F="cropper-crop",j="cropper-disabled",E="mousedown touchstart pointerdown MSPointerDown",z="mousemove touchmove pointermove MSPointerMove",M="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",I="wheel mousewheel DOMMouseScroll",X="dblclick",A="load."+$,H="error."+$,O="resize."+$,R="build."+$,P="built."+$,W="cropstart."+$,Y="cropmove."+$,N="cropend."+$,U="crop."+$,q="zoom."+$,Q=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,G=/^data:/,K=/^data:([^;]+);base64,/,V=/^data:image\/jpeg.*;base64,/,Z="preview",J="action",tt="e",et="w",it="s",at="n",rt="se",ot="sw",nt="ne",st="nw",lt="all",dt="crop",ct="move",ht="zoom",pt=t.isFunction(t("<canvas>")[0].getContext),ut=x&&/(Macintosh|iPhone|iPod|iPad).*AppleWebKit/i.test(x.userAgent),mt=Number,ft=Math.min,gt=Math.max,vt=Math.abs,bt=Math.sin,wt=Math.cos,_t=Math.sqrt,xt=Math.round,yt=Math.floor,Ct=String.fromCharCode;v.prototype={constructor:v,init:function(){var t,e=this.$element;if(e.is("img")){if(this.isImg=!0,this.originalUrl=t=e.attr("src"),!t)return;t=e.prop("src")}else e.is("canvas")&&pt&&(t=e[0].toDataURL());this.load(t)},trigger:function(e,i){var a=t.Event(e,i);return this.$element.trigger(a),a},load:function(e){var i,a,r=this.options,s=this.$element;if(e&&(s.one(R,r.build),!this.trigger(R).isDefaultPrevented())){if(this.url=e,this.image={},!r.checkOrientation||!y)return this.clone();if(i=t.proxy(this.read,this),G.test(e))return V.test(e)?i(f(e)):this.clone();a=new XMLHttpRequest,a.onerror=a.onabort=t.proxy(function(){this.clone()},this),a.onload=function(){i(this.response)},r.checkCrossOrigin&&o(e)&&s.prop("crossOrigin")&&(e=n(e)),a.open("get",e),a.responseType="arraybuffer",a.send()}},read:function(t){var e=this.options,i=m(t),a=this.image,r=0,o=1,n=1;if(i>1)switch(this.url=g(t),i){case 2:o=-1;break;case 3:r=-180;break;case 4:n=-1;break;case 5:r=90,n=-1;break;case 6:r=90;break;case 7:r=90,o=-1;break;case 8:r=-90}e.rotatable&&(a.rotate=r),e.scalable&&(a.scaleX=o,a.scaleY=n),this.clone()},clone:function(){var e,i,a=this.options,r=this.$element,l=this.url,d="";a.checkCrossOrigin&&o(l)&&(d=r.prop("crossOrigin"),d?e=l:(d="anonymous",e=n(l))),this.crossOrigin=d,this.crossOriginUrl=e,this.$clone=i=t("<img"+s(d)+' src="'+(e||l)+'">'),this.isImg?r[0].complete?this.start():r.one(A,t.proxy(this.start,this)):i.one(A,t.proxy(this.start,this)).one(H,t.proxy(this.stop,this)).addClass(S).insertAfter(r)},start:function(){var e=this.$element,i=this.$clone;this.isImg||(i.off(H,this.stop),e=i),l(e[0],t.proxy(function(e,i){t.extend(this.image,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i}),this.isLoaded=!0,this.build()},this))},stop:function(){this.$clone.remove(),this.$clone=null},build:function(){var e,i,a,r=this.options,o=this.$element,n=this.$clone;this.isLoaded&&(this.isBuilt&&this.unbuild(),this.$container=o.parent(),this.$cropper=e=t(v.TEMPLATE),this.$canvas=e.find(".cropper-canvas").append(n),this.$dragBox=e.find(".cropper-drag-box"),this.$cropBox=i=e.find(".cropper-crop-box"),this.$viewBox=e.find(".cropper-view-box"),this.$face=a=i.find(".cropper-face"),o.addClass(L).after(e),this.isImg||n.removeClass(S),this.initPreview(),this.bind(),r.aspectRatio=gt(0,r.aspectRatio)||NaN,r.viewMode=gt(0,ft(3,xt(r.viewMode)))||0,r.autoCrop?(this.isCropped=!0,r.modal&&this.$dragBox.addClass(T)):i.addClass(L),r.guides||i.find(".cropper-dashed").addClass(L),r.center||i.find(".cropper-center").addClass(L),r.cropBoxMovable&&a.addClass(B).data(J,lt),r.highlight||a.addClass("cropper-invisible"),r.background&&e.addClass("cropper-bg"),r.cropBoxResizable||i.find(".cropper-line, .cropper-point").addClass(L),this.setDragMode(r.dragMode),this.render(),this.isBuilt=!0,this.setData(r.data),o.one(P,r.built),this.completing=setTimeout(t.proxy(function(){this.trigger(P),this.trigger(U,this.getData()),this.isCompleted=!0},this),0))},unbuild:function(){this.isBuilt&&(this.isCompleted||clearTimeout(this.completing),this.isBuilt=!1,this.isCompleted=!1,this.initialImage=null,this.initialCanvas=null,this.initialCropBox=null,this.container=null,this.canvas=null,this.cropBox=null,this.unbind(),this.resetPreview(),this.$preview=null,this.$viewBox=null,this.$cropBox=null,this.$dragBox=null,this.$canvas=null,this.$container=null,this.$cropper.remove(),this.$cropper=null)},render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.isCropped&&this.renderCropBox()},initContainer:function(){var t=this.options,e=this.$element,i=this.$container,a=this.$cropper;a.addClass(L),e.removeClass(L),a.css(this.container={width:gt(i.width(),mt(t.minContainerWidth)||200),height:gt(i.height(),mt(t.minContainerHeight)||100)}),e.addClass(L),a.removeClass(L)},initCanvas:function(){var e,i=this.options.viewMode,a=this.container,r=a.width,o=a.height,n=this.image,s=n.naturalWidth,l=n.naturalHeight,d=90===vt(n.rotate),c=d?l:s,h=d?s:l,p=c/h,u=r,m=o;o*p>r?3===i?u=o*p:m=r/p:3===i?m=r/p:u=o*p,e={naturalWidth:c,naturalHeight:h,aspectRatio:p,width:u,height:m},e.oldLeft=e.left=(r-u)/2,e.oldTop=e.top=(o-m)/2,this.canvas=e,this.isLimited=1===i||2===i,this.limitCanvas(!0,!0),this.initialImage=t.extend({},n),this.initialCanvas=t.extend({},e)},limitCanvas:function(t,e){var i,a,r,o,n=this.options,s=n.viewMode,l=this.container,d=l.width,c=l.height,h=this.canvas,p=h.aspectRatio,u=this.cropBox,m=this.isCropped&&u;t&&(i=mt(n.minCanvasWidth)||0,a=mt(n.minCanvasHeight)||0,s&&(s>1?(i=gt(i,d),a=gt(a,c),3===s&&(a*p>i?i=a*p:a=i/p)):i?i=gt(i,m?u.width:0):a?a=gt(a,m?u.height:0):m&&(i=u.width,a=u.height,a*p>i?i=a*p:a=i/p)),i&&a?a*p>i?a=i/p:i=a*p:i?a=i/p:a&&(i=a*p),h.minWidth=i,h.minHeight=a,h.maxWidth=Infinity,h.maxHeight=Infinity),e&&(s?(r=d-h.width,o=c-h.height,h.minLeft=ft(0,r),h.minTop=ft(0,o),h.maxLeft=gt(0,r),h.maxTop=gt(0,o),m&&this.isLimited&&(h.minLeft=ft(u.left,u.left+u.width-h.width),h.minTop=ft(u.top,u.top+u.height-h.height),h.maxLeft=u.left,h.maxTop=u.top,2===s&&(h.width>=d&&(h.minLeft=ft(0,r),h.maxLeft=gt(0,r)),h.height>=c&&(h.minTop=ft(0,o),h.maxTop=gt(0,o))))):(h.minLeft=-h.width,h.minTop=-h.height,h.maxLeft=d,h.maxTop=c))},renderCanvas:function(t){var e,i,a=this.canvas,r=this.image,o=r.rotate,n=r.naturalWidth,s=r.naturalHeight;this.isRotated&&(this.isRotated=!1,i=c({width:r.width,height:r.height,degree:o}),(e=i.width/i.height)!==a.aspectRatio&&(a.left-=(i.width-a.width)/2,a.top-=(i.height-a.height)/2,a.width=i.width,a.height=i.height,a.aspectRatio=e,a.naturalWidth=n,a.naturalHeight=s,o%180&&(i=c({width:n,height:s,degree:o}),a.naturalWidth=i.width,a.naturalHeight=i.height),this.limitCanvas(!0,!1))),(a.width>a.maxWidth||a.width<a.minWidth)&&(a.left=a.oldLeft),(a.height>a.maxHeight||a.height<a.minHeight)&&(a.top=a.oldTop),a.width=ft(gt(a.width,a.minWidth),a.maxWidth),a.height=ft(gt(a.height,a.minHeight),a.maxHeight),this.limitCanvas(!1,!0),a.oldLeft=a.left=ft(gt(a.left,a.minLeft),a.maxLeft),a.oldTop=a.top=ft(gt(a.top,a.minTop),a.maxTop),this.$canvas.css({width:a.width,height:a.height,left:a.left,top:a.top}),this.renderImage(),this.isCropped&&this.isLimited&&this.limitCropBox(!0,!0),t&&this.output()},renderImage:function(e){var i,a=this.canvas,r=this.image;r.rotate&&(i=c({width:a.width,height:a.height,degree:r.rotate,aspectRatio:r.aspectRatio},!0)),t.extend(r,i?{width:i.width,height:i.height,left:(a.width-i.width)/2,top:(a.height-i.height)/2}:{width:a.width,height:a.height,left:0,top:0}),this.$clone.css({width:r.width,height:r.height,marginLeft:r.left,marginTop:r.top,transform:d(r)}),e&&this.output()},initCropBox:function(){var e=this.options,i=this.canvas,a=e.aspectRatio,r=mt(e.autoCropArea)||.8,o={width:i.width,height:i.height};a&&(i.height*a>i.width?o.height=o.width/a:o.width=o.height*a),this.cropBox=o,this.limitCropBox(!0,!0),o.width=ft(gt(o.width,o.minWidth),o.maxWidth),o.height=ft(gt(o.height,o.minHeight),o.maxHeight),o.width=gt(o.minWidth,o.width*r),o.height=gt(o.minHeight,o.height*r),o.oldLeft=o.left=i.left+(i.width-o.width)/2,o.oldTop=o.top=i.top+(i.height-o.height)/2,this.initialCropBox=t.extend({},o)},limitCropBox:function(t,e){var i,a,r,o,n=this.options,s=n.aspectRatio,l=this.container,d=l.width,c=l.height,h=this.canvas,p=this.cropBox,u=this.isLimited;t&&(i=mt(n.minCropBoxWidth)||0,a=mt(n.minCropBoxHeight)||0,i=ft(i,d),a=ft(a,c),r=ft(d,u?h.width:d),o=ft(c,u?h.height:c),s&&(i&&a?a*s>i?a=i/s:i=a*s:i?a=i/s:a&&(i=a*s),o*s>r?o=r/s:r=o*s),p.minWidth=ft(i,r),p.minHeight=ft(a,o),p.maxWidth=r,p.maxHeight=o),e&&(u?(p.minLeft=gt(0,h.left),p.minTop=gt(0,h.top),p.maxLeft=ft(d,h.left+h.width)-p.width,p.maxTop=ft(c,h.top+h.height)-p.height):(p.minLeft=0,p.minTop=0,p.maxLeft=d-p.width,p.maxTop=c-p.height))},renderCropBox:function(){var t=this.options,e=this.container,i=e.width,a=e.height,r=this.cropBox;(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft),(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop),r.width=ft(gt(r.width,r.minWidth),r.maxWidth),r.height=ft(gt(r.height,r.minHeight),r.maxHeight),this.limitCropBox(!1,!0),r.oldLeft=r.left=ft(gt(r.left,r.minLeft),r.maxLeft),r.oldTop=r.top=ft(gt(r.top,r.minTop),r.maxTop),t.movable&&t.cropBoxMovable&&this.$face.data(J,r.width===i&&r.height===a?ct:lt),this.$cropBox.css({width:r.width,height:r.height,left:r.left,top:r.top}),this.isCropped&&this.isLimited&&this.limitCanvas(!0,!0),this.isDisabled||this.output()},output:function(){this.preview(),this.isCompleted&&this.trigger(U,this.getData())},initPreview:function(){var e,i=s(this.crossOrigin),a=i?this.crossOriginUrl:this.url;this.$preview=t(this.options.preview),this.$clone2=e=t("<img"+i+' src="'+a+'">'),this.$viewBox.html(e),this.$preview.each(function(){var e=t(this);e.data(Z,{width:e.width(),height:e.height(),html:e.html()}),e.html("<img"+i+' src="'+a+'" style="display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;">')})},resetPreview:function(){this.$preview.each(function(){var e=t(this),i=e.data(Z);e.css({width:i.width,height:i.height}).html(i.html).removeData(Z)})},preview:function(){var e=this.image,i=this.canvas,a=this.cropBox,r=a.width,o=a.height,n=e.width,s=e.height,l=a.left-i.left-e.left,c=a.top-i.top-e.top;this.isCropped&&!this.isDisabled&&(this.$clone2.css({width:n,height:s,marginLeft:-l,marginTop:-c,transform:d(e)}),this.$preview.each(function(){var i=t(this),a=i.data(Z),h=a.width,p=a.height,u=h,m=p,f=1;r&&(f=h/r,m=o*f),o&&m>p&&(f=p/o,u=r*f,m=p),i.css({width:u,height:m}).find("img").css({width:n*f,height:s*f,marginLeft:-l*f,marginTop:-c*f,transform:d(e)})}))},bind:function(){var e=this.options,i=this.$element,a=this.$cropper;t.isFunction(e.cropstart)&&i.on(W,e.cropstart),t.isFunction(e.cropmove)&&i.on(Y,e.cropmove),t.isFunction(e.cropend)&&i.on(N,e.cropend),t.isFunction(e.crop)&&i.on(U,e.crop),t.isFunction(e.zoom)&&i.on(q,e.zoom),a.on(E,t.proxy(this.cropStart,this)),e.zoomable&&e.zoomOnWheel&&a.on(I,t.proxy(this.wheel,this)),e.toggleDragModeOnDblclick&&a.on(X,t.proxy(this.dblclick,this)),w.on(z,this._cropMove=r(this.cropMove,this)).on(M,this._cropEnd=r(this.cropEnd,this)),e.responsive&&b.on(O,this._resize=r(this.resize,this))},unbind:function(){var e=this.options,i=this.$element,a=this.$cropper;t.isFunction(e.cropstart)&&i.off(W,e.cropstart),t.isFunction(e.cropmove)&&i.off(Y,e.cropmove),t.isFunction(e.cropend)&&i.off(N,e.cropend),t.isFunction(e.crop)&&i.off(U,e.crop),t.isFunction(e.zoom)&&i.off(q,e.zoom),a.off(E,this.cropStart),e.zoomable&&e.zoomOnWheel&&a.off(I,this.wheel),e.toggleDragModeOnDblclick&&a.off(X,this.dblclick),w.off(z,this._cropMove).off(M,this._cropEnd),e.responsive&&b.off(O,this._resize)},resize:function(){var e,i,a,r=this.options.restore,o=this.$container,n=this.container;!this.isDisabled&&n&&(1==(a=o.width()/n.width)&&o.height()===n.height||(r&&(e=this.getCanvasData(),i=this.getCropBoxData()),this.render(),r&&(this.setCanvasData(t.each(e,function(t,i){e[t]=i*a})),this.setCropBoxData(t.each(i,function(t,e){i[t]=e*a})))))},dblclick:function(){this.isDisabled||(this.$dragBox.hasClass(F)?this.setDragMode(ct):this.setDragMode(dt))},wheel:function(e){var i=e.originalEvent||e,a=mt(this.options.wheelZoomRatio)||.1,r=1;this.isDisabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(t.proxy(function(){this.wheeling=!1},this),50),i.deltaY?r=i.deltaY>0?1:-1:i.wheelDelta?r=-i.wheelDelta/120:i.detail&&(r=i.detail>0?1:-1),this.zoom(-r*a,e)))},cropStart:function(e){var i,a,r=this.options,o=e.originalEvent,n=o&&o.touches,s=e;if(!this.isDisabled){if(n){if((i=n.length)>1){if(!r.zoomable||!r.zoomOnTouch||2!==i)return;s=n[1],this.startX2=s.pageX,this.startY2=s.pageY,a=ht}s=n[0]}if(a=a||t(s.target).data(J),Q.test(a)){if(this.trigger(W,{originalEvent:o,action:a}).isDefaultPrevented())return;e.preventDefault(),this.action=a,this.cropping=!1,this.startX=s.pageX||o&&o.pageX,this.startY=s.pageY||o&&o.pageY,a===dt&&(this.cropping=!0,this.$dragBox.addClass(T))}}},cropMove:function(t){var e,i=this.options,a=t.originalEvent,r=a&&a.touches,o=t,n=this.action;if(!this.isDisabled){if(r){if((e=r.length)>1){if(!i.zoomable||!i.zoomOnTouch||2!==e)return;o=r[1],this.endX2=o.pageX,this.endY2=o.pageY}o=r[0]}if(n){if(this.trigger(Y,{originalEvent:a,action:n}).isDefaultPrevented())return;t.preventDefault(),this.endX=o.pageX||a&&a.pageX,this.endY=o.pageY||a&&a.pageY,this.change(o.shiftKey,n===ht?t:null)}}},cropEnd:function(t){var e=t.originalEvent,i=this.action;this.isDisabled||i&&(t.preventDefault(),this.cropping&&(this.cropping=!1,this.$dragBox.toggleClass(T,this.isCropped&&this.options.modal)),this.action="",this.trigger(N,{originalEvent:e,action:i}))},change:function(t,e){var i,a,r=this.options,o=r.aspectRatio,n=this.action,s=this.container,l=this.canvas,d=this.cropBox,c=d.width,h=d.height,p=d.left,u=d.top,m=p+c,f=u+h,g=0,v=0,b=s.width,w=s.height,_=!0;switch(!o&&t&&(o=c&&h?c/h:1),this.isLimited&&(g=d.minLeft,v=d.minTop,b=g+ft(s.width,l.width,l.left+l.width),w=v+ft(s.height,l.height,l.top+l.height)),a={x:this.endX-this.startX,y:this.endY-this.startY},o&&(a.X=a.y*o,a.Y=a.x/o),n){case lt:p+=a.x,u+=a.y;break;case tt:if(a.x>=0&&(m>=b||o&&(u<=v||f>=w))){_=!1;break}c+=a.x,o&&(h=c/o,u-=a.Y/2),c<0&&(n=et,c=0);break;case at:if(a.y<=0&&(u<=v||o&&(p<=g||m>=b))){_=!1;break}h-=a.y,u+=a.y,o&&(c=h*o,p+=a.X/2),h<0&&(n=it,h=0)
;break;case et:if(a.x<=0&&(p<=g||o&&(u<=v||f>=w))){_=!1;break}c-=a.x,p+=a.x,o&&(h=c/o,u+=a.Y/2),c<0&&(n=tt,c=0);break;case it:if(a.y>=0&&(f>=w||o&&(p<=g||m>=b))){_=!1;break}h+=a.y,o&&(c=h*o,p-=a.X/2),h<0&&(n=at,h=0);break;case nt:if(o){if(a.y<=0&&(u<=v||m>=b)){_=!1;break}h-=a.y,u+=a.y,c=h*o}else a.x>=0?m<b?c+=a.x:a.y<=0&&u<=v&&(_=!1):c+=a.x,a.y<=0?u>v&&(h-=a.y,u+=a.y):(h-=a.y,u+=a.y);c<0&&h<0?(n=ot,h=0,c=0):c<0?(n=st,c=0):h<0&&(n=rt,h=0);break;case st:if(o){if(a.y<=0&&(u<=v||p<=g)){_=!1;break}h-=a.y,u+=a.y,c=h*o,p+=a.X}else a.x<=0?p>g?(c-=a.x,p+=a.x):a.y<=0&&u<=v&&(_=!1):(c-=a.x,p+=a.x),a.y<=0?u>v&&(h-=a.y,u+=a.y):(h-=a.y,u+=a.y);c<0&&h<0?(n=rt,h=0,c=0):c<0?(n=nt,c=0):h<0&&(n=ot,h=0);break;case ot:if(o){if(a.x<=0&&(p<=g||f>=w)){_=!1;break}c-=a.x,p+=a.x,h=c/o}else a.x<=0?p>g?(c-=a.x,p+=a.x):a.y>=0&&f>=w&&(_=!1):(c-=a.x,p+=a.x),a.y>=0?f<w&&(h+=a.y):h+=a.y;c<0&&h<0?(n=nt,h=0,c=0):c<0?(n=rt,c=0):h<0&&(n=st,h=0);break;case rt:if(o){if(a.x>=0&&(m>=b||f>=w)){_=!1;break}c+=a.x,h=c/o}else a.x>=0?m<b?c+=a.x:a.y>=0&&f>=w&&(_=!1):c+=a.x,a.y>=0?f<w&&(h+=a.y):h+=a.y;c<0&&h<0?(n=st,h=0,c=0):c<0?(n=ot,c=0):h<0&&(n=nt,h=0);break;case ct:this.move(a.x,a.y),_=!1;break;case ht:this.zoom(function(t,e,i,a){var r=_t(t*t+e*e);return(_t(i*i+a*a)-r)/r}(vt(this.startX-this.startX2),vt(this.startY-this.startY2),vt(this.endX-this.endX2),vt(this.endY-this.endY2)),e),this.startX2=this.endX2,this.startY2=this.endY2,_=!1;break;case dt:if(!a.x||!a.y){_=!1;break}i=this.$cropper.offset(),p=this.startX-i.left,u=this.startY-i.top,c=d.minWidth,h=d.minHeight,a.x>0?n=a.y>0?rt:nt:a.x<0&&(p-=c,n=a.y>0?ot:st),a.y<0&&(u-=h),this.isCropped||(this.$cropBox.removeClass(L),this.isCropped=!0,this.isLimited&&this.limitCropBox(!0,!0))}_&&(d.width=c,d.height=h,d.left=p,d.top=u,this.action=n,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY},crop:function(){this.isBuilt&&!this.isDisabled&&(this.isCropped||(this.isCropped=!0,this.limitCropBox(!0,!0),this.options.modal&&this.$dragBox.addClass(T),this.$cropBox.removeClass(L)),this.setCropBoxData(this.initialCropBox))},reset:function(){this.isBuilt&&!this.isDisabled&&(this.image=t.extend({},this.initialImage),this.canvas=t.extend({},this.initialCanvas),this.cropBox=t.extend({},this.initialCropBox),this.renderCanvas(),this.isCropped&&this.renderCropBox())},clear:function(){this.isCropped&&!this.isDisabled&&(t.extend(this.cropBox,{left:0,top:0,width:0,height:0}),this.isCropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),this.$dragBox.removeClass(T),this.$cropBox.addClass(L))},replace:function(t,e){!this.isDisabled&&t&&(this.isImg&&this.$element.attr("src",t),e?(this.url=t,this.$clone.attr("src",t),this.isBuilt&&this.$preview.find("img").add(this.$clone2).attr("src",t)):(this.isImg&&(this.isReplaced=!0),this.options.data=null,this.load(t)))},enable:function(){this.isBuilt&&(this.isDisabled=!1,this.$cropper.removeClass(j))},disable:function(){this.isBuilt&&(this.isDisabled=!0,this.$cropper.addClass(j))},destroy:function(){var t=this.$element;this.isLoaded?(this.isImg&&this.isReplaced&&t.attr("src",this.originalUrl),this.unbuild(),t.removeClass(L)):this.isImg?t.off(A,this.start):this.$clone&&this.$clone.remove(),t.removeData($)},move:function(t,e){var a=this.canvas;this.moveTo(i(t)?t:a.left+mt(t),i(e)?e:a.top+mt(e))},moveTo:function(t,a){var r=this.canvas,o=!1;i(a)&&(a=t),t=mt(t),a=mt(a),this.isBuilt&&!this.isDisabled&&this.options.movable&&(e(t)&&(r.left=t,o=!0),e(a)&&(r.top=a,o=!0),o&&this.renderCanvas(!0))},zoom:function(t,e){var i=this.canvas;t=mt(t),t=t<0?1/(1-t):1+t,this.zoomTo(i.width*t/i.naturalWidth,e)},zoomTo:function(t,e){var i,a,r,o,n,s=this.options,l=this.canvas,d=l.width,c=l.height,h=l.naturalWidth,u=l.naturalHeight;if((t=mt(t))>=0&&this.isBuilt&&!this.isDisabled&&s.zoomable){if(a=h*t,r=u*t,e&&(i=e.originalEvent),this.trigger(q,{originalEvent:i,oldRatio:d/h,ratio:a/h}).isDefaultPrevented())return;i?(o=this.$cropper.offset(),n=i.touches?p(i.touches):{pageX:e.pageX||i.pageX||0,pageY:e.pageY||i.pageY||0},l.left-=(a-d)*((n.pageX-o.left-l.left)/d),l.top-=(r-c)*((n.pageY-o.top-l.top)/c)):(l.left-=(a-d)/2,l.top-=(r-c)/2),l.width=a,l.height=r,this.renderCanvas(!0)}},rotate:function(t){this.rotateTo((this.image.rotate||0)+mt(t))},rotateTo:function(t){t=mt(t),e(t)&&this.isBuilt&&!this.isDisabled&&this.options.rotatable&&(this.image.rotate=t%360,this.isRotated=!0,this.renderCanvas(!0))},scale:function(t,a){var r=this.image,o=!1;i(a)&&(a=t),t=mt(t),a=mt(a),this.isBuilt&&!this.isDisabled&&this.options.scalable&&(e(t)&&(r.scaleX=t,o=!0),e(a)&&(r.scaleY=a,o=!0),o&&this.renderImage(!0))},scaleX:function(t){var i=this.image.scaleY;this.scale(t,e(i)?i:1)},scaleY:function(t){var i=this.image.scaleX;this.scale(e(i)?i:1,t)},getData:function(e){var i,a,r=this.options,o=this.image,n=this.canvas,s=this.cropBox;return this.isBuilt&&this.isCropped?(a={x:s.left-n.left,y:s.top-n.top,width:s.width,height:s.height},i=o.width/o.naturalWidth,t.each(a,function(t,r){r/=i,a[t]=e?xt(r):r})):a={x:0,y:0,width:0,height:0},r.rotatable&&(a.rotate=o.rotate||0),r.scalable&&(a.scaleX=o.scaleX||1,a.scaleY=o.scaleY||1),a},setData:function(i){var a,r,o,n=this.options,s=this.image,l=this.canvas,d={};t.isFunction(i)&&(i=i.call(this.element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(i)&&(n.rotatable&&e(i.rotate)&&i.rotate!==s.rotate&&(s.rotate=i.rotate,this.isRotated=a=!0),n.scalable&&(e(i.scaleX)&&i.scaleX!==s.scaleX&&(s.scaleX=i.scaleX,r=!0),e(i.scaleY)&&i.scaleY!==s.scaleY&&(s.scaleY=i.scaleY,r=!0)),a?this.renderCanvas():r&&this.renderImage(),o=s.width/s.naturalWidth,e(i.x)&&(d.left=i.x*o+l.left),e(i.y)&&(d.top=i.y*o+l.top),e(i.width)&&(d.width=i.width*o),e(i.height)&&(d.height=i.height*o),this.setCropBoxData(d))},getContainerData:function(){return this.isBuilt?this.container:{}},getImageData:function(){return this.isLoaded?this.image:{}},getCanvasData:function(){var e=this.canvas,i={};return this.isBuilt&&t.each(["left","top","width","height","naturalWidth","naturalHeight"],function(t,a){i[a]=e[a]}),i},setCanvasData:function(i){var a=this.canvas,r=a.aspectRatio;t.isFunction(i)&&(i=i.call(this.$element)),this.isBuilt&&!this.isDisabled&&t.isPlainObject(i)&&(e(i.left)&&(a.left=i.left),e(i.top)&&(a.top=i.top),e(i.width)?(a.width=i.width,a.height=i.width/r):e(i.height)&&(a.height=i.height,a.width=i.height*r),this.renderCanvas(!0))},getCropBoxData:function(){var t,e=this.cropBox;return this.isBuilt&&this.isCropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(i){var a,r,o=this.cropBox,n=this.options.aspectRatio;t.isFunction(i)&&(i=i.call(this.$element)),this.isBuilt&&this.isCropped&&!this.isDisabled&&t.isPlainObject(i)&&(e(i.left)&&(o.left=i.left),e(i.top)&&(o.top=i.top),e(i.width)&&(a=!0,o.width=i.width),e(i.height)&&(r=!0,o.height=i.height),n&&(a?o.height=o.width/n:r&&(o.width=o.height*n)),this.renderCropBox())},getCroppedCanvas:function(e){var i,a,r,o,n,s,l,d,c,p,u;if(this.isBuilt&&pt)return this.isCropped?(t.isPlainObject(e)||(e={}),u=this.getData(),i=u.width,a=u.height,d=i/a,t.isPlainObject(e)&&(n=e.width,s=e.height,n&&s?l=n/i:n?(s=n/d,l=n/i):s&&(n=s*d,l=s/a)),r=yt(n||i),o=yt(s||a),c=t("<canvas>")[0],c.width=r,c.height=o,p=c.getContext("2d"),e.fillColor&&(p.fillStyle=e.fillColor,p.fillRect(0,0,r,o)),p.drawImage.apply(p,function(){var t,e,r,o,n,s,d=h(this.$clone[0],this.image),c=d.width,p=d.height,m=this.canvas,f=[d],g=u.x+m.naturalWidth*(vt(u.scaleX||1)-1)/2,v=u.y+m.naturalHeight*(vt(u.scaleY||1)-1)/2;return g<=-i||g>c?g=t=r=n=0:g<=0?(r=-g,g=0,t=n=ft(c,i+g)):g<=c&&(r=0,t=n=ft(i,c-g)),t<=0||v<=-a||v>p?v=e=o=s=0:v<=0?(o=-v,v=0,e=s=ft(p,a+v)):v<=p&&(o=0,e=s=ft(a,p-v)),f.push(yt(g),yt(v),yt(t),yt(e)),l&&(r*=l,o*=l,n*=l,s*=l),n>0&&s>0&&f.push(yt(r),yt(o),yt(n),yt(s)),f}.call(this)),c):h(this.$clone[0],this.image)},setAspectRatio:function(t){var e=this.options;this.isDisabled||i(t)||(e.aspectRatio=gt(0,t)||NaN,this.isBuilt&&(this.initCropBox(),this.isCropped&&this.renderCropBox()))},setDragMode:function(t){var e,i,a=this.options;this.isLoaded&&!this.isDisabled&&(e=t===dt,i=a.movable&&t===ct,t=e||i?t:"none",this.$dragBox.data(J,t).toggleClass(F,e).toggleClass(B,i),a.cropBoxMovable||this.$face.data(J,t).toggleClass(F,e).toggleClass(B,i))}},v.DEFAULTS={viewMode:0,dragMode:"crop",aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},v.setDefaults=function(e){t.extend(v.DEFAULTS,e)},v.TEMPLATE='<div class="cropper-container"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div>',v.other=t.fn.cropper,t.fn.cropper=function(e){var r,o=a(arguments,1);return this.each(function(){var i,a,n=t(this),s=n.data($);if(!s){if(/destroy/.test(e))return;i=t.extend({},n.data(),t.isPlainObject(e)&&e),n.data($,s=new v(this,i))}"string"==typeof e&&t.isFunction(a=s[e])&&(r=a.apply(s,o))}),i(r)?this:r},t.fn.cropper.Constructor=v,t.fn.cropper.setDefaults=v.setDefaults,t.fn.cropper.noConflict=function(){return t.fn.cropper=v.other,this}}),jQuery(function(){$.fn.ajax_modal=function(t){return $(this).click(function(e){var i=$(this).attr("title");i=""==i?$(this).attr("data-original-title"):i;var a={title:i||$(this).data("title"),mode:"ajax",url:$(this).attr("href"),show_footer:$(this).data("show_footer")};$(this).attr("data-modal_size")&&(a.modal_size=$(this).attr("data-modal_size")),open_modal($.extend({},a,t)),e.preventDefault()}),this},$.fn.alert=function(t){hideLoading();var e={title:I18n("msg.updated_success"),type:"success",zindex:"99999999",id:"cama_alert_modal"};t=$.extend(e,t||{}),"error"==t.type&&(t.type="danger"),"alert"==t.type&&(t.type="warning"),t.content||(t.content=t.title,t.title=""),open_modal(t)}}),jQuery(function(){$.fn.customLoading2=function(t){t||(t="show"),"string"==typeof t&&(t={state:t});var e=$.extend({},{percentage:100,state:"show"},t);"show"==e.state?0==$("body > #custom_loading").length?$("body").append('<div id="custom_loading" style="position: fixed; z-index: 99999; width: 100%; top: 0px; height: 15px;" class="progress"><div class="progress-bar progress-bar-striped active progress-bar-success" role="progressbar" aria-valuenow="45" aria-valuemin="0" aria-valuemax="100" style="width: '+e.percentage+'%;"><span class="sr-only">45% Complete</span></div></div>'):$("body > #custom_loading").width(e.percentage):$("body > #custom_loading").remove()},$.fn.customLoading=function(t){t||(t="show"),"string"==typeof t&&(t={state:t});var e=$.extend({},{percentage:100,state:"show"},t);"show"==e.state?0==$("body > #cama_custom_loading").length?$("body").append('<div id="cama_custom_loading"><div class="back_spinner"></div><div class="loader_spinner"></div></div>'):$("body > #cama_custom_loading").width(e.percentage):$("body > #cama_custom_loading").remove()}});